name: Prototype
args: {
  frame             : {type: "choice", value: "phone", options: ["simple", "phone", "desktop"], name: "Frame", hidden: true},
  numPages          : {type: "number", value: 3, min: 1, name: "Numbers of pages"},
  maxCols           : {type: "number", value: 10, min: 1, name: "Max per row"},
  cornerRadius      : {type: "number", value: 40, min: 0, name: "Corner radius"},
  pageMargin        : {type: "number", value: 60, min: 0, name: "Page margin"},
  background        : {type: "advanced-color", value: { type: "solid", color: "rgba(240, 240, 240, 1)" }, name: "Background"},
  strokeColor       : {type: "color", value: "rgba(212,212,212,1.0)", name: "Stroke color"},
  strokeSize        : {type: "number", value: 1, min: 0, name: "Stroke size"},
}

import:
  - ../diagrams/src/item.sch
  - ./src/prototype.sch

handlers:
  delete: onDeleteItem(itemId, item)

description: Helps designing a basic app prototype with multiple app pages. Each page has an "Open Page" event that, once triggered, displays that page on top.
preview: data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhodG1sPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iLTQgLTQgMjQ4IDM2OCI+PGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDApIHJvdGF0ZSgwKSIgZGF0YS1zdmctaXRlbS1jb250YWluZXItaWQ9ImE1VmxwYU04QiIgZGF0YS1pdGVtLWlkPSJhNVZscGFNOEIiPiAgPGcgc3R5bGU9Im9wYWNpdHk6IDE7IG1peC1ibGVuZC1tb2RlOiBub3JtYWw7Ij4gPGRlZnMvPiA8ZyBmaWx0ZXI9IiI+IDxnIHN0eWxlPSJvcGFjaXR5OiAxOyI+PGc+PGc+PGc+IDwvZz4gPHBhdGggZD0iTSAyMjAgMzYwICBMIDIwIDM2MCBhIDIwIDIwIDAgMCAxIC0yMCAtMjAgIEwgMCAyMCAgYSAyMCAyMCAwIDAgMSAyMCAtMjAgICBMIDIyMCAwICAgYSAyMCAyMCAwIDAgMSAyMCAyMCAgTCAyNDAgMzQwICAgYSAyMCAyMCAwIDAgMSAtMjAgMjAgWiIgc3Ryb2tlLXdpZHRoPSIycHgiIHN0cm9rZT0icmdiYSgxNjAsIDE2MCwgMTYwLCAxKSIgc3Ryb2tlLWRhc2hhcnJheT0iIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJyZ2JhKDIwOCwgMjA4LCAyMDgsIDEpIi8+PC9nPjwvZz48L2c+ICA8ZyBzdHlsZT0ib3BhY2l0eTogMTsiLz48L2c+ICAgICAgICA8Zz48ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDIwLDIwKSI+ICA8ZyBzdHlsZT0ib3BhY2l0eTogMTsgbWl4LWJsZW5kLW1vZGU6IG5vcm1hbDsiPiA8ZGVmcy8+IDxnIGZpbHRlcj0iIj4gPGcgc3R5bGU9Im9wYWNpdHk6IDE7Ii8+ICA8ZyBzdHlsZT0ib3BhY2l0eTogMTsiPjxmb3JlaWduT2JqZWN0IGlkPSJpdGVtLXRleHQtc2xvdC16b1h4S1Zqb2YtYm9keSIgeD0iMCIgeT0iMCIgd2lkdGg9IjIwMCIgaGVpZ2h0PSI0MCI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgY2xhc3M9Iml0ZW0tdGV4dC1jb250YWluZXIiIHN0eWxlPSJjb2xvcjogcmdiKDExMSwgMTExLCAxMTEpOyBmb250LXNpemU6IDI5cHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2EsIHNhbnMtc2VyaWY7IHBhZGRpbmc6IDBweDsgdGV4dC1hbGlnbjogY2VudGVyOyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyBkaXNwbGF5OiB0YWJsZS1jZWxsOyBib3gtc2l6aW5nOiBib3JkZXItYm94OyBmb250LXdlaWdodDogYm9sZDsgd2lkdGg6IDIwMHB4OyBoZWlnaHQ6IDQwcHg7Ij48ZGl2IGNsYXNzPSJpdGVtLXRleHQtZWxlbWVudCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsiPjxwIHN0eWxlPSJtYXJnaW4tdG9wOiAwcHg7IG1hcmdpbi1ib3R0b206IDBweDsgcGFkZGluZzogMHB4OyBtaW4taGVpZ2h0OiAxOHB4OyI+QXBwIFByb3RvdHlwZTwvcD48L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz4gICAgICAgICA8L2c+PC9nPjxnIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsNDAsMjQwKSI+ICA8ZyBzdHlsZT0ib3BhY2l0eTogMTsgbWl4LWJsZW5kLW1vZGU6IG5vcm1hbDsiPiA8ZGVmcy8+IDxnIGZpbHRlcj0iIj4gPGcgc3R5bGU9Im9wYWNpdHk6IDE7Ij48Zz48Zz48Zz4gPC9nPiA8cGF0aCBkPSJNIDE0NSA0MCAgTCAxNSA0MCBhIDE1IDE1IDAgMCAxIC0xNSAtMTUgIEwgMCAxNSAgYSAxNSAxNSAwIDAgMSAxNSAtMTUgICBMIDE0NSAwICAgYSAxNSAxNSAwIDAgMSAxNSAxNSAgTCAxNjAgMjUgICBhIDE1IDE1IDAgMCAxIC0xNSAxNSBaIiBzdHJva2Utd2lkdGg9IjJweCIgc3Ryb2tlPSJyZ2JhKDE1NCwgMTU0LCAxNTQsIDEpIiBzdHJva2UtZGFzaGFycmF5PSIiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9InJnYmEoMTAzLCAxMDMsIDEwMywgMSkiLz48L2c+PC9nPjwvZz4gIDxnIHN0eWxlPSJvcGFjaXR5OiAxOyI+PGZvcmVpZ25PYmplY3QgaWQ9Iml0ZW0tdGV4dC1zbG90LXhNdXdxWHkycy1ib2R5IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYwIiBoZWlnaHQ9IjQwIj48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBjbGFzcz0iaXRlbS10ZXh0LWNvbnRhaW5lciIgc3R5bGU9ImNvbG9yOiByZ2IoMjU1LCAyNTUsIDI1NSk7IGZvbnQtc2l6ZTogMjBweDsgZm9udC1mYW1pbHk6IEFyaWFsLCBIZWx2ZXRpY2EsIHNhbnMtc2VyaWY7IHBhZGRpbmc6IDBweDsgdGV4dC1hbGlnbjogY2VudGVyOyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyBkaXNwbGF5OiB0YWJsZS1jZWxsOyBib3gtc2l6aW5nOiBib3JkZXItYm94OyB3aWR0aDogMTYwcHg7IGhlaWdodDogNDBweDsgZm9udC13ZWlnaHQ6IGJvbGQ7Ij48ZGl2IGNsYXNzPSJpdGVtLXRleHQtZWxlbWVudCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsiPjxwIHN0eWxlPSJtYXJnaW4tdG9wOiAwcHg7IG1hcmdpbi1ib3R0b206IDBweDsgcGFkZGluZzogMHB4OyBtaW4taGVpZ2h0OiAxOHB4OyI+T3BlbjwvcD48L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz4gICAgICAgICA8L2c+PC9nPjxnIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsNDAuMDAwMDAwMDAwMDAwMTE0LDMwMCkiPiAgPGcgc3R5bGU9Im9wYWNpdHk6IDE7IG1peC1ibGVuZC1tb2RlOiBub3JtYWw7Ij4gPGRlZnMvPiA8ZyBmaWx0ZXI9IiI+IDxnIHN0eWxlPSJvcGFjaXR5OiAxOyI+PGc+PGc+PGc+IDwvZz4gPHBhdGggZD0iTSAxNDUgNDAgIEwgMTUgNDAgYSAxNSAxNSAwIDAgMSAtMTUgLTE1ICBMIDAgMTUgIGEgMTUgMTUgMCAwIDEgMTUgLTE1ICAgTCAxNDUgMCAgIGEgMTUgMTUgMCAwIDEgMTUgMTUgIEwgMTYwIDI1ICAgYSAxNSAxNSAwIDAgMSAtMTUgMTUgWiIgc3Ryb2tlLXdpZHRoPSIycHgiIHN0cm9rZT0icmdiYSgxNTQsIDE1NCwgMTU0LCAxKSIgc3Ryb2tlLWRhc2hhcnJheT0iIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBmaWxsPSJyZ2JhKDEwMywgMTAzLCAxMDMsIDEpIi8+PC9nPjwvZz48L2c+ICA8ZyBzdHlsZT0ib3BhY2l0eTogMTsiPjxmb3JlaWduT2JqZWN0IGlkPSJpdGVtLXRleHQtc2xvdC1rUlI5UE83dGUtYm9keSIgeD0iMCIgeT0iMCIgd2lkdGg9IjE2MCIgaGVpZ2h0PSI0MCI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgY2xhc3M9Iml0ZW0tdGV4dC1jb250YWluZXIiIHN0eWxlPSJjb2xvcjogcmdiKDI1NSwgMjU1LCAyNTUpOyBmb250LXNpemU6IDIwcHg7IGZvbnQtZmFtaWx5OiBBcmlhbCwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmOyBwYWRkaW5nOiAwcHg7IHRleHQtYWxpZ246IGNlbnRlcjsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgZGlzcGxheTogdGFibGUtY2VsbDsgYm94LXNpemluZzogYm9yZGVyLWJveDsgd2lkdGg6IDE2MHB4OyBoZWlnaHQ6IDQwcHg7IGZvbnQtd2VpZ2h0OiBib2xkOyI+PGRpdiBjbGFzcz0iaXRlbS10ZXh0LWVsZW1lbnQiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Ij48cCBzdHlsZT0ibWFyZ2luLXRvcDogMHB4OyBtYXJnaW4tYm90dG9tOiAwcHg7IHBhZGRpbmc6IDBweDsgbWluLWhlaWdodDogMThweDsiPkJhY2s8L3A+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+ICAgICAgICAgPC9nPjwvZz48ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDQwLDgwKSI+ICA8ZyBzdHlsZT0ib3BhY2l0eTogMTsgbWl4LWJsZW5kLW1vZGU6IG5vcm1hbDsiPiA8ZGVmcy8+IDxnIGZpbHRlcj0iIj4gPGcgc3R5bGU9Im9wYWNpdHk6IDE7Ij48Zz48Zz48Zz4gPC9nPiA8cGF0aCBkPSJNIDE0MCAxMjAgIEwgMjAgMTIwIGEgMjAgMjAgMCAwIDEgLTIwIC0yMCAgTCAwIDIwICBhIDIwIDIwIDAgMCAxIDIwIC0yMCAgIEwgMTQwIDAgICBhIDIwIDIwIDAgMCAxIDIwIDIwICBMIDE2MCAxMDAgICBhIDIwIDIwIDAgMCAxIC0yMCAyMCBaIiBzdHJva2Utd2lkdGg9IjJweCIgc3Ryb2tlPSJyZ2JhKDE2MCwgMTYwLCAxNjAsIDEpIiBzdHJva2UtZGFzaGFycmF5PSIiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGZpbGw9InJnYmEoMjI3LCAyMjQsIDIyNCwgMSkiLz48L2c+PC9nPjwvZz4gIDxnIHN0eWxlPSJvcGFjaXR5OiAxOyIvPjwvZz4gICAgICAgICA8L2c+PC9nPjwvZz4gPC9nPjwvZz48L3N2Zz4=
controls:
  - name: addPage
    type: button
    text: Add page
    x: {$-expr: "(numPages % maxCols) * (width + pageMargin) + width + 10" }
    y: {$-expr: "floor(numPages / maxCols) * (height + pageMargin)" }
    width: 120
    height: 30
    click:
      - numPages += 1

  - $-for: { start: 0, until: {$-expr: numPages }, it: idx }
    $-if: numPages > 1
    data:
      pageIndex: { $-expr: idx }
    selectedItemId: { $-str: "page-${idx+1}" }
    name: removeSlide
    type: button
    text: "â¤«"
    placement: BL
    x: {$-expr: "((idx+1) % maxCols) * (width + pageMargin) + width"}
    y: {$-expr: "floor((idx+1) / maxCols) * (height + pageMargin)"}
    width: 20
    height: 20
    click:
      - deletePage(control.data.pageIndex)

  - $-for: { start: 1, until: {$-expr: "numPages + 1"}, it: idx}
    name: duplicatePage
    text: Duplicate page
    type: button
    data:
      pageIndex: {$-expr: idx}
    selectedItemId: {$-str: "page-${idx}"}
    x: {$-expr: "(idx % maxCols) * (width + pageMargin) + width/2 - 60"}
    y: {$-expr: "floor(idx / maxCols) * (height + pageMargin) + height + 5"}
    width: 120
    height: 30
    click:
      - duplicatePage(control.data.pageIndex)

editor:
    panels:
      - id: frame
        type: item-menu
        click: 'selectFrame(panelItem)'
        name: Frame
        slotSize:
            width: 100
            height: 100
        items:
          - id: 'simple'
            toggled: {$-expr: "frame == 'simple'"}
            name: Simple
            shape: 'rect'
            area: {x: 10, w: 72, h: 90}
            shapeProps:
              cornerRadius: 5
              fill: { type: solid, color: 'rgba(255,255,255,1)'}
              strokeSize: 1
              strokeColor: 'rgba(155,155,155,1)'

          - id: 'phone'
            toggled: {$-expr: "frame == 'phone'"}
            name: Phone
            shape: 'image'
            area: {x: 0, y: 5, w: 90, h: 80}
            shapeProps:
              image: /assets/templates/prototypes/phone.svg
              fill: { type: none }
              strokeSize: 0

          - id: 'desktop'
            toggled: {$-expr: "frame == 'desktop'"}
            name: Desktop
            shape: 'image'
            area: {x: 0, y: 5, w: 90, h: 90}
            shapeProps:
              image: /assets/templates/prototypes/desktop.svg
              fill: { type: none }
              strokeSize: 0


item:
  id: root
  name: Slides
  shape: rect
  area:
    x: 0
    "y": 0
    w: {$-expr: width}
    h: {$-expr: height}
    r: 0
    px: 0.5
    py: 0.5
    sx: 1
    sy: 1
  shapeProps:
    cornerRadius: {$-expr: cornerRadius}
    fill:
      type: none
    strokeColor: {$-expr: strokeColor}
    strokeSize: {$-expr: strokeSize}
    strokePattern: solid
  opacity: 100
  selfOpacity: 100
  visible: true
  clip: false
  behavior:
    events:
      - id: init
        event: init
        actions:
          - $-for: {start: 2, until: {$-expr: "numPages + 1"}, it: idx}
            id: {$-str: "hide-page-${idx}"}
            element: {$-str: "#page-${idx}"}
            method: hide
            args:
              animated: false

          - $-for: {start: 1, until: {$-expr: "numPages + 1"}, it: idx}
            id: {$-str: "hide-title-${idx}"}
            element: {$-str: "#page-title-${idx}"}
            method: hide
            args:
              animated: false

          - id: "set-var-current"
            element: self
            method: script
            args:
              script: setVar('currentPage', 1)

          - id: identify-connectors
            element: self
            method: script
            args:
              script: |
                findChildItemsByTag('prototype-page').forEach(page => {
                    Connections.findConnectionsWith(page).forEach(otherItem => {
                        Connections.findConnections(page, otherItem).forEach(connector => {
                            connector.hide()
                        })
                        otherItem.assignEvent('clicked', () => {
                            page.sendEvent('Open Page')
                        })
                    })
                })
  textSlots:
    body:
      text: |
        <p>This is a root of the page. <b>Do not use it</b>. Instead add items to other pages.</p>
        <p>Each page has "<b>Open page</b>" event, which, when triggered,
        displays the page on top of the root item</p>
      color: rgba(170, 170, 170, 1)

  childItems:
    - $-for: {start: 1, until: {$-expr: "numPages + 1"}, it: idx}
      id: {$-str: "page-${idx}"}
      name: {$-str: "Page ${idx}"}
      args:
        templateIgnoredProps:
          - name
      clip: {$-expr: frameClip }
      shape: rect
      tags:
        - $-str: page-${idx}
        - prototype-page
      area:
        x: {$-expr: "(((idx-1) % maxCols) + 1) * (width + pageMargin)"}
        y: {$-expr: "floor((idx-1) / maxCols) * (height + pageMargin)"}
        w: {$-expr: width}
        h: {$-expr: height}
        r: 0
        px: 0.5
        py: 0.5
        sx: 1
        sy: 1
      shapeProps:
        cornerRadius: {$-expr: frameCornerRadius}
        fill: {$-expr: frameFill}
        strokeColor: {$-expr: frameStrokeColor}
        strokeSize: {$-expr: frameStrokeSize}
        strokePattern: solid

      childItems:
        - $-if: "isSimpleFrame"
          id: {$-str: "page-container-${idx}"}
          name: {$-str: "Page container ${idx}"}
          clip: true
          area:
            x: 0
            y: 0
            w: {$-expr: "width"}
            h: {$-expr: "height"}
          shape: rect
          shapeProps:
            cornerRadius: {$-expr: "max(0, cornerRadius - 6)"}
            fill: {$-expr: background}
            strokeColor: "rgba(240,240,240,1.0)"
            strokeSize: 0
            strokePattern: solid

        - $-foreach: {source: "phoneButtons", it: "b"}
          id: {$-str: "${b.id}-${idx}"}
          name: "Button"
          weld: true
          mount: false
          area:
            x: {$-expr: b.x}
            y: {$-expr: b.y}
            w: {$-expr: b.w}
            h: {$-expr: b.h}
          shape: rect
          shapeProps:
            cornerRadius: 3
            fill: {$-expr: frameFill}
            strokeColor: "rgba(20,20,20,1.0)"
            strokeSize: 0

        - $-foreach: {source: "desktopButtons", it: "b"}
          id: {$-str: "${b.id}-${idx}"}
          name: "Button"
          weld: true
          mount: false
          area:
            x: {$-expr: b.x}
            y: {$-expr: b.y}
            w: {$-expr: b.w}
            h: {$-expr: b.h}
          shape: rect
          shapeProps:
            cornerRadius: 10
            fill:
              type: solid
              color: "rgba(150,150,150,1.0)"
            strokeColor: "rgba(20,20,20,1.0)"
            strokeSize: 0

        - $-if: "frame == 'phone'"
          id: {$-str: "black-layer-${idx}"}
          name: Black layer
          mount: false
          weld: true
          area:
            x: 4
            y: 4
            w: {$-expr: "max(1, width - 8)"}
            h: {$-expr: "max(1, height - 8)"}
          shape: rect
          shapeProps:
            cornerRadius: {$-expr: "max(0, cornerRadius - 4)"}
            fill:
              type: "solid"
              color: "rgba(20, 20, 20, 1)"
            strokeColor: "rgba(20,20,20,1.0)"
            strokeSize: 0
            strokePattern: solid
          childItems:
            - id: {$-str: "page-container-${idx}"}
              name: {$-str: "Page container ${idx}"}
              clip: true
              weld: true
              mount: true
              area:
                x: 6
                y: 6
                w: {$-expr: "max(1, width - 20)"}
                h: {$-expr: "max(1, height - 20)"}
              shape: rect
              shapeProps:
                cornerRadius: {$-expr: "max(0, cornerRadius - 6)"}
                fill: {$-expr: background}
                strokeColor: "rgba(240,240,240,1.0)"
                strokeSize: 0
                strokePattern: solid
            - id: {$-str: "page-camera-overlay-${idx}"}
              name: "Page camera overlay"
              area:
                x: {$-expr: "(width - 8)/2 - cameraOverlayWidth/2"}
                y: 12
                w: {$-expr: cameraOverlayWidth}
                h: {$-expr: cameraOverlayHeight}
              mount: false
              weld: true
              shape: rect
              shapeProps:
                cornerRadius: {$-expr: cameraOverlayHeight}
                fill:
                  color: "rgba(20, 20, 20, 1)"
                  type: "solid"
                strokeColor:  "rgba(20, 20, 20, 1)"
                strokeSize: 0
              childItems:
                - id: {$-str: "camera-lense-${idx}"}
                  name: Camera Lense
                  mount: false
                  weld: true
                  area:
                    x: {$-expr: "cameraOverlayWidth - cameraLenseSize - cameraLensePadding"}
                    y: {$-expr: "cameraLensePadding"}
                    w: {$-expr: cameraLenseSize}
                    h: {$-expr: cameraLenseSize}
                  shape: ellipse
                  shapeProps:
                    cornerRadius: {$-expr: cameraOverlayHeight}
                    fill:
                      color: "rgba(60, 60, 60, 1)"
                      type: "solid"
                    strokeColor:  "rgba(60, 60, 60, 1)"
                    strokeSize: 0

        - $-if: "frame == 'desktop'"
          id: {$-str: "page-container-${idx}"}
          name: {$-str: "Page container ${idx}"}
          clip: true
          weld: true
          mount: true
          area:
            x: 1
            y: 30
            w: {$-expr: "max(1, width - 2)"}
            h: {$-expr: "max(1, height - 31)"}
          shape: rect
          shapeProps:
            cornerRadius: 0
            varCorners: true
            r2: 0
            r3: {$-expr: frameCornerRadius}
            r4: {$-expr: frameCornerRadius}
            fill: {$-expr: background}
            strokeColor: "rgba(240,240,240,1.0)"
            strokeSize: 0
            strokePattern: solid




      behavior:
        events:
          - id: init
            event: init
            actions:
              - $-if: "idx != 1"
                id: hide-self
                element: self
                method: hide
                args:
                  animated: false

              - id: move-to-root
                element: self
                method: moveToItem
                args:
                  destinationItem: '#root'
                  matchPoint: top-left
                  animated: false

          - id: open-page
            event: Open Page
            actions:
              - id: 'condition'
                element: '#root'
                method: condition
                args:
                  expression: {$-str: "getVar('currentPage') == ${idx}"}
                  fail: pass
                  success: break-event

              - id: root-simple-script
                element: '#root'
                method: script
                args:
                  script:
                    $-str: |
                      currentPage = getVar('currentPage')
                      findChildItemsByTag('page-' + currentPage).forEach((page) => {
                          page.hide()
                      })
                      findChildItemsByTag('page-' + ${idx}).forEach((page) => {
                          page.show()
                      })
                      setVar('currentPage', ${idx})
      textSlots: {}

    - $-for: {start: 1, until: {$-expr: "numPages + 1"}, it: idx}
      id: {$-str: "page-title-${idx}"}
      name: {$-str: "Page ${idx}"}
      shape: none
      area:
        x: {$-expr: "(((idx-1) % maxCols) + 1) * (width + pageMargin)"}
        y: {$-expr: "floor((idx-1) / maxCols) * (height + pageMargin) - 30"}
        w: {$-expr: width}
        h: 30
        r: 0
        px: 0.5
        py: 0.5
        sx: 1
        sy: 1
      shapeProps: {}
      textSlots:
        body:
          text: {$-str: "Page ${idx}"}